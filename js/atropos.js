var Atropos=function(){"use strict";function t(){return(t=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(t[a]=o[a])}return t}).apply(this,arguments)}var e=function t(e,o){return e.querySelector(o)},o=function t(e){void 0===e&&(e={});var o={};return Object.keys(e).forEach(function(t){void 0!==e[t]&&(o[t]=e[t])}),o},a={alwaysActive:!1,activeOffset:50,shadowOffset:50,shadowScale:1,duration:300,rotate:!0,rotateTouch:!0,rotateXMax:15,rotateYMax:15,rotateXInvert:!1,rotateYInvert:!1,stretchX:0,stretchY:0,stretchZ:0,commonOrigin:!0,shadow:!0,highlight:!0};return function n(r){void 0===r&&(r={});var i,s,p,c,u,l,$,d,f,v,h,m,y=r,g=y.el,_=y.eventsEl,x=r.isComponent,w={__atropos__:!0,params:t({},a,{onEnter:null,onLeave:null,onRotate:null},o(r||{})),destroyed:!1,isActive:!1},X=w.params,Y=[];!function t(){m=requestAnimationFrame(function(){Y.forEach(function(t){if("function"==typeof t)t();else{var e=t.element,o=t.prop,a=t.value;e.style[o]=a}}),Y.splice(0,Y.length),t()})}();var O,L,T=function t(e,o){Y.push({element:e,prop:"transitionDuration",value:o})},A=function t(e,o){Y.push({element:e,prop:"transitionTimingFunction",value:o})},M=function t(e,o){Y.push({element:e,prop:"transform",value:o})},b=function t(e,o){Y.push({element:e,prop:"opacity",value:o})},E=function t(e,o){Y.push({element:e,prop:"transformOrigin",value:o})},R=function t(e,o,a,n){return e.addEventListener(o,a,n)},I=function t(e,o,a,n){return e.removeEventListener(o,a,n)},P=function t(e){var o,a=e.rotateXPercentage,n=void 0===a?0:a,r=e.rotateYPercentage,s=void 0===r?0:r,p=e.duration,c=e.opacityOnly,u=e.easeOut,l=function t(e){if(e.dataset.atroposOpacity&&"string"==typeof e.dataset.atroposOpacity)return e.dataset.atroposOpacity.split(";").map(function(t){return parseFloat(t)})};(o=i).querySelectorAll("[data-atropos-offset], [data-atropos-opacity]").forEach(function(t){T(t,p),A(t,u?"ease-out":"");var e=l(t);if(0===n&&0===s)c||M(t,"translate3d(0, 0, 0)"),e&&b(t,e[0]);else{var o=parseFloat(t.dataset.atroposOffset)/100;if(Number.isNaN(o)||c||M(t,"translate3d("+-(-s*o)+"%, "+-(n*o)+"%, 0)"),e){var a,r=e[0];b(t,r+(e[1]-r)*Math.max(Math.abs(n),Math.abs(s))/100)}}})},C=function t(e,o){var a,n=g!==_;if(u||(u=g.getBoundingClientRect()),n&&!l&&(l=_.getBoundingClientRect()),void 0===e&&void 0===o){var r=n?l:u;e=r.left+r.width/2,o=r.top+r.height/2}var i=0,p=0,c=u,$=c.top,f=c.left,v=c.width,h=c.height;if(n){var m=l,y=m.top,x=m.left,w=m.width,Y=m.height,O=e-x,L=o-y;p=-(X.rotateYMax*(O-(v/2+(f-x)))/(w-v/2)*1),i=X.rotateXMax*(L-(h/2+($-y)))/(Y-h/2),a=e-f+"px "+(o-$)+"px"}else{var R=e-f,I=o-$;p=-(X.rotateYMax*(R-v/2)/(v/2)*1),i=X.rotateXMax*(I-h/2)/(h/2)}i=Math.min(Math.max(-i,-X.rotateXMax),X.rotateXMax),X.rotateXInvert&&(i=-i),p=Math.min(Math.max(-p,-X.rotateYMax),X.rotateYMax),X.rotateYInvert&&(p=-p);var C,D=i/X.rotateXMax*100,S=p/X.rotateYMax*100,k=(n?S/100*X.stretchX:0)*(X.rotateYInvert?-1:1);M(s,"translate3d("+k+"%, "+-((n?D/100*X.stretchY:0)*(X.rotateXInvert?-1:1))+"%, "+-(n?Math.max(Math.abs(D),Math.abs(S))/100*X.stretchZ:0)+"px) rotateX("+i+"deg) rotateY("+p+"deg)"),a&&X.commonOrigin&&E(s,a),d&&(T(d,X.duration+"ms"),A(d,"ease-out"),M(d,"translate3d("+-(.25*S)+"%, "+.25*D+"%, 0)"),b(d,Math.max(Math.abs(D),Math.abs(S))/100)),P({rotateXPercentage:D,rotateYPercentage:S,duration:X.duration+"ms",easeOut:!0}),"function"==typeof X.onRotate&&X.onRotate(i,p)},D=function t(){Y.push(function(){return g.classList.add("atropos-active")}),T(s,X.duration+"ms"),A(s,"ease-out"),M(p,"translate3d(0,0, "+X.activeOffset+"px)"),T(p,X.duration+"ms"),A(p,"ease-out"),$&&(T($,X.duration+"ms"),A($,"ease-out")),w.isActive=!0},S=function t(e){if(f=void 0,("pointerdown"!==e.type||"mouse"!==e.pointerType)&&("pointerenter"!==e.type||"mouse"===e.pointerType)){if("pointerdown"===e.type&&e.preventDefault(),v=e.clientX,h=e.clientY,X.alwaysActive){u=void 0,l=void 0;return}D(),"function"==typeof X.onEnter&&X.onEnter()}},k=function t(e){!1===f&&e.cancelable&&e.preventDefault()},N=function t(e){if(X.rotate&&w.isActive){if("mouse"!==e.pointerType){if(!X.rotateTouch)return;e.preventDefault()}var o=e.clientX,a=e.clientY,n=o-v,r=a-h;if("string"==typeof X.rotateTouch&&(0!==n||0!==r)&&void 0===f){if(n*n+r*r>=25){var i=180*Math.atan2(Math.abs(r),Math.abs(n))/Math.PI;f="scroll-y"===X.rotateTouch?i>45:90-i>45}!1===f&&(g.classList.add("atropos-rotate-touch"),e.cancelable&&e.preventDefault())}("mouse"===e.pointerType||!f)&&C(o,a)}},q=function t(e){if(u=void 0,l=void 0,w.isActive&&(!e||"pointerup"!==e.type||"mouse"!==e.pointerType)&&(!e||"pointerleave"!==e.type||"mouse"===e.pointerType)){if("string"==typeof X.rotateTouch&&f&&g.classList.remove("atropos-rotate-touch"),X.alwaysActive){C(),"function"==typeof X.onRotate&&X.onRotate(0,0),"function"==typeof X.onLeave&&X.onLeave();return}Y.push(function(){return g.classList.remove("atropos-active")}),T(p,X.duration+"ms"),A(p,""),M(p,"translate3d(0,0, 0px)"),$&&(T($,X.duration+"ms"),A($,"")),d&&(T(d,X.duration+"ms"),A(d,""),M(d,"translate3d(0, 0, 0)"),b(d,0)),T(s,X.duration+"ms"),A(s,""),M(s,"translate3d(0,0,0) rotateX(0deg) rotateY(0deg)"),P({duration:X.duration+"ms"}),w.isActive=!1,"function"==typeof X.onRotate&&X.onRotate(0,0),"function"==typeof X.onLeave&&X.onLeave()}},B=function t(e){var o=e.target;!_.contains(o)&&o!==_&&w.isActive&&q()},Z=function t(){w.destroyed=!0,cancelAnimationFrame(m),I(document,"click",B),I(_,"pointerdown",S),I(_,"pointerenter",S),I(_,"pointermove",N),I(_,"touchmove",k),I(_,"pointerleave",q),I(_,"pointerup",q),I(_,"lostpointercapture",q),delete g.__atropos__};return w.destroy=Z,"string"==typeof g&&(g=e(document,g)),g&&(g.__atropos__||(void 0!==_?"string"==typeof _&&(_=e(document,_)):_=g,i=x?g.parentNode.host:g,Object.assign(w,{el:g}),s=e(g,".atropos-rotate"),p=e(g,".atropos-scale"),c=e(g,".atropos-inner"),g.__atropos__=w)),g&&_&&(X.shadow&&(($=e(g,".atropos-shadow"))||(($=document.createElement("span")).classList.add("atropos-shadow"),O=!0),M($,"translate3d(0,0,-"+X.shadowOffset+"px) scale("+X.shadowScale+")"),O&&s.appendChild($)),X.highlight&&((d=e(g,".atropos-highlight"))||((d=document.createElement("span")).classList.add("atropos-highlight"),L=!0),M(d,"translate3d(0,0,0)"),L&&c.appendChild(d)),X.rotateTouch&&("string"==typeof X.rotateTouch?g.classList.add("atropos-rotate-touch-"+X.rotateTouch):g.classList.add("atropos-rotate-touch")),e(i,"[data-atropos-opacity]")&&P({opacityOnly:!0}),R(document,"click",B),R(_,"pointerdown",S),R(_,"pointerenter",S),R(_,"pointermove",N),R(_,"touchmove",k),R(_,"pointerleave",q),R(_,"pointerup",q),R(_,"lostpointercapture",q),X.alwaysActive&&(D(),C())),w}}();